<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meu Perfil - Pizzaria Giacommini</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https:
    <link href="https:
</head>
<body>
    
    <nav class="navbar">
        <div class="container nav-content">
            <a href="/" class="brand">
                <i class="fas fa-pizza-slice"></i> Pizzaria Giacommini
            </a>
            <div class="nav-links">
                <a href="/" class="nav-link">Cardápio</a>
                <a href="/profile.html" class="nav-link active">Meu Perfil</a>
                <button onclick="logout()" class="btn btn-outline" style="padding: 8px 16px; font-size: 0.9rem;">
                    <i class="fas fa-sign-out-alt"></i> Sair
                </button>
            </div>
        </div>
    </nav>

    <main class="container" style="margin-top: 60px; margin-bottom: 60px;">
        <div class="card" style="max-width: 800px; margin: 0 auto; padding: 40px;">
            <h1 style="margin-bottom: 30px; color: var(--bg-contrast);">
                <i class="fas fa-user-circle"></i> Meu Perfil
            </h1>

            <div id="profile-info" style="margin-bottom: 30px;">
                
            </div>

            <div style="border-top: 1px solid #eee; padding-top: 30px;">
                <h2 style="margin-bottom: 20px; color: var(--bg-contrast); font-size: 1.5rem;">Meus Pedidos</h2>
                <div id="user-orders">
                    <p style="color: var(--text-muted); text-align: center;">Carregando pedidos...</p>
                </div>
            </div>
        </div>
    </main>

    <footer class="footer">
        <div class="container text-center">
            <p>&copy; 2025 Pizzaria Giacommini. Todos os direitos reservados.</p>
        </div>
    </footer>

    <script>
        const currentUser = JSON.parse(localStorage.getItem('user_data') || 'null');

        if (!currentUser) {
            window.location.href = '/login.html';
        }

        const profileInfo = document.getElementById('profile-info');
        profileInfo.innerHTML = `
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                <div style="background: var(--bg-body); padding: 20px; border-radius: var(--radius-md);">
                    <h3 style="color: var(--text-muted); font-size: 0.9rem; margin-bottom: 5px;">Nome</h3>
                    <p style="font-size: 1.1rem; color: var(--bg-contrast);">${currentUser.nome || 'N/A'}</p>
                </div>
                <div style="background: var(--bg-body); padding: 20px; border-radius: var(--radius-md);">
                    <h3 style="color: var(--text-muted); font-size: 0.9rem; margin-bottom: 5px;">Telefone</h3>
                    <p style="font-size: 1.1rem; color: var(--bg-contrast);">${currentUser.telefone || 'N/A'}</p>
                </div>
                <div style="background: var(--bg-body); padding: 20px; border-radius: var(--radius-md);">
                    <h3 style="color: var(--text-muted); font-size: 0.9rem; margin-bottom: 5px;">Email</h3>
                    <p style="font-size: 1.1rem; color: var(--bg-contrast);">${currentUser.email || 'N/A'}</p>
                </div>
                <div style="background: var(--bg-body); padding: 20px; border-radius: var(--radius-md); grid-column: 1 / -1;">
                    <h3 style="color: var(--text-muted); font-size: 0.9rem; margin-bottom: 5px;">Endereço</h3>
                    <p style="font-size: 1.1rem; color: var(--bg-contrast);">${currentUser.endereco || 'N/A'}</p>
                </div>
            </div>
        `;

        async function loadUserOrders() {
            try {
                const response = await fetch(`/api/pedidos?telefone=${currentUser.telefone}`);
                if (response.ok) {
                    const orders = await response.json();
                    displayOrders(orders);
                } else {
                    document.getElementById('user-orders').innerHTML = '<p style="color: var(--text-muted); text-align: center;">Nenhum pedido encontrado.</p>';
                }
            } catch (err) {
                console.error(err);
                document.getElementById('user-orders').innerHTML = '<p style="color: var(--error); text-align: center;">Erro ao carregar pedidos.</p>';
            }
        }

        function displayOrders(orders) {
            const container = document.getElementById('user-orders');
            if (orders.length === 0) {
                container.innerHTML = '<p style="color: var(--text-muted); text-align: center;">Você ainda não fez nenhum pedido.</p>';
                return;
            }

            container.innerHTML = orders.map(order => `
                <div style="background: var(--bg-body); padding: 20px; border-radius: var(--radius-md); margin-bottom: 15px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <h3 style="color: var(--bg-contrast); font-size: 1.1rem;">Pedido #${order.index}</h3>
                        <span style="background: var(--primary); color: white; padding: 5px 10px; border-radius: var(--radius-sm); font-size: 0.85rem;">
                            ${order.status}
                        </span>
                    </div>
                    <p style="color: var(--text-muted); font-size: 0.9rem; margin-bottom: 5px;">
                        <i class="fas fa-calendar"></i> ${order.data}
                    </p>
                    <p style="color: var(--text-muted); font-size: 0.9rem; margin-bottom: 5px;">
                        <i class="fas fa-credit-card"></i> ${order.formapagamento}
                    </p>
                    <p style="color: var(--bg-contrast); font-size: 1.1rem; font-weight: bold; margin-top: 10px;">
                        Total: R$ ${parseFloat(order.custototal).toFixed(2)}
                    </p>
                </div>
            `).join('');
        }

        function logout() {
            if (confirm('Deseja realmente sair?')) {
                localStorage.removeItem('user_data');
                window.location.href = '/';
            }
        }

        loadUserOrders();
    </script>
</body>
</html>

